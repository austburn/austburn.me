---
- name: setup user
  hosts: all

  tasks:
    - name: create group
      group: name=austin state=present

    - name: create user
      user: name=austin groups=sudo,austin shell=/bin/bash generate_ssh_key=yes

    - name: nopasswd
      lineinfile: dest=/etc/sudoers state=present line="austin ALL=(ALL) NOPASSWD:ALL" create=yes validate='visudo -cf %s'

    - name: add authorized keys
      authorized_key: user=austin key=https://github.com/austburn.keys

    - name: remove root keys
      file: path=/root/.ssh/authorized_keys state=absent

    - name: disable root password
      command: passwd -d root
